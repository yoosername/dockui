key: dockui.dashboard.app
alias: dashboard
name: DockUI Dashboard App
url: http://localhost:3000/demo
type: dynamic
description: This is a demo Dashboard App showing of the various features of the DockUI framework
version: 1.0.0
descriptorVersion: 1.0.0
icon: "/static/images/logo.png"
lifecycle:
  - loaded: /loaded
authentication:
  - type: jwt
modules:
  # Provides:
  #   Routing at the base level for prettier URLs
  - type: Route
    name: Dashboard App Routes
    key: dockui.routes.common
    routes:
      - from: /*
        to: /apps/dockui.dashboard.app/index$1
      - from: /login*
        to: /apps/dockui.dashboard.app/login$1
    weight: 0

  # # Provides:
  # #   Store of user ids with attached profile info ( e.g. username, password hash, fullname etc )
  # - type: UserDirectory
  #   name: Simple File Based User DB
  #   key: dockui.directory.users.fileDB
  #   url: /users
  #   weight: 1

  # Provides:
  #   Identification checking for existing sessions
  #     (e.g. if creds in header, return a real user object from some userDB)
  #   Authentication flow for unidentified users
  #     (e.g. if no creds in header or creds wrong, send 501 or 301 request redirect to login page (provided elsewhere)
  - type: AuthenticationProvider
    name: Form Auth Provider
    key: dockui.dashboard.auth.form
    url: /identity_check
    weight: 1

  # Provides:
  #   Check that the logged in Principle (user/service) has access to the requested resource
  #     - if user is known and access granted return 200
  #     - if user is known but access is not granted return 401
  #     - if user is not known return 501 Not Implemented
  - type: AuthorizationProvider
    name: Simple Role Based Permissions service
    key: dockui.dashboard.permissions
    url: /permission_check
    weight: 1

    # Inject single Link (cached forever until module disabled/unloaded)
  - type: WebItem
    name: Link to disabled Page
    key: dockui.dashboard.links.disabledPageLink
    url: /app/dashboard/disabled
    text: Goto Disabled Page
    location: dockui.dashboard.index.header.links
    tooltip: This is a Tooltip (Hint)
    weight: 10
    cache:
      enabled: true

    # Inject Page fragment
  - type: WebFragment
    name: Dashboard Widget
    key: dockui.dashboard.fragments.widget
    url: /fragments/widget.html
    selector: "#fragment-selector"
    location: dashboard.home.main
    weight: 10
    cache:
      enabled: true
      ttl: 60000ms
    # The difference between leaving auth off and this is that this will require a
    # user to at least be logged in but could be any user
    access:
      type: Role
      allowed:
        - EVERYONE

    # Serve Static Resources & inject at existing page location
  - type: WebResource
    name: Dashboard Static Resources
    key: dockui.dashboard.resources
    url: /static
    resources:
      - type: js
        path: js/example.javascript.js
      - type: css
        path: css/example.style.css
    context: dashboard.*
    weight: 100
    cache:
      enabled: true
      ttl: 600000ms

    # Serve Web Page (optionally decorated by another page)
  - type: WebPage
    name: Dashboard Home
    key: dockui.dashboard
    # Aliases are relative to the App root e.g. <scheme>://<host>/app/<appAlias>/<moduleAlias>
    # and act as a full replacement for the default which is the key of the module
    aliases:
      - /
      - /index
      - /index.html
    url: /pages/home.html
    caching:
      enabled: true
      ttl: 2000ms
    access:
      type: Role
      allowed:
        - UNAUTHENTICATED
        - EVERYONE
    # This dictates the startup behaviour only
    enabled: true

  - type: WebPage
    name: Example Webpage that starts life disabled
    key: dockui.dashboard.disabled
    url: /pages/disabled.html
    aliases:
      - /disabled
    enabled: false

    # Proxy request directly to an existing API
  - type: Api
    name: Dashboard Backend
    key: dockui.dashboard.api
    version: 1.0
    url: /rest/api/1.0/
    caching:
      enabled: true
      ttl: 60000ms
    access:
      type: Role
      allowed:
        - EVERYONE
      disallowed:
        - UNAUTHENTICATED

    # Receive POST request on given framework events
  - type: Webhook
    name: Dashboard Webhook
    key: dockui.dashboard.webhook
    url: /hook
    events:
      - app:enabled
